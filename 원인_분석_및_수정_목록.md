# 원인 분석 및 수정 목록

## 문제 1: 검사 결과 페이지 뒤로 돌아가기 버튼 문제

### 원인 1-1: 검사 결과 페이지 로드 시 플래그 확인 누락
- **현재 상태**: 검사 완료 시 `sessionStorage`에만 플래그 저장, 검사 결과 페이지 로드 시 확인하지 않음
- **문제점**: 페이지가 로드될 때 플래그를 확인하지 않아서, 다른 방법으로 접근했을 때 플래그를 확인할 수 없음
- **해결 방법**: 검사 결과 페이지 로드 시 `testJustCompleted` 플래그를 확인하고, 상태로 저장

### 원인 1-2: 검사 완료 직후와 검사 기록 목록에서 접근 구분 불가
- **현재 상태**: 둘 다 `code` 파라미터를 가지고 있어서 구분이 어려움
- **문제점**: 검사 완료 직후에도 `code` 파라미터가 있어서, 검사 기록 목록에서 접근한 것으로 오인될 수 있음
- **해결 방법**: 검사 완료 시 URL에 `from=completion` 파라미터 추가

## 문제 2: 개인용 MBTI 검사 진행 중인 검사 팝업 문제

### 원인 2-1: testId 불일치 문제
- **현재 상태**: 고정된 `testId` 사용 (`generateTestId(pathname)`)
- **문제점**: 이전에 타임스탬프를 포함한 `testId`로 저장했다면 찾을 수 없음
- **해결 방법**: 진행 중인 검사를 찾을 때 고정된 `testId` 기반으로 검색하되, 타임스탬프를 제거한 기본 testId로도 검색

### 원인 2-2: useEffect 의존성 문제
- **현재 상태**: `useEffect`가 `testId`와 `searchParams`에 의존하지만, `testId`가 변경되지 않으면 재실행되지 않음
- **문제점**: 컴포넌트가 마운트된 후 진행 중인 검사가 생성되면 감지하지 못할 수 있음
- **해결 방법**: 컴포넌트 마운트 시 명시적으로 진행 상태 확인, 또는 `useEffect` 로직 개선

### 원인 2-3: shouldShowResumeDialog가 올바른 testId로 검사하지 않음
- **현재 상태**: `shouldShowResumeDialog(testId)` 호출 시 고정된 testId만 사용
- **문제점**: 진행 중인 검사가 다른 testId로 저장되어 있을 수 있음
- **해결 방법**: 모든 개인용 MBTI 검사 진행 상태를 검색하여 찾기

